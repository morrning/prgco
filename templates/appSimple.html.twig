{% extends 'withNavbar.html.twig' %}
{% block pageBody %}
    <!-- Page Content -->
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-3">
            <div class="row">
                <div class="col-12 pb-1">
                    {% set countdowns = EntityMGR.findAll('App:Countdown') %}
                    <div class="card">
                        <img class="card-img-top" src="{{ asset('assets/images/public/countdown.jpg') }}" alt="Card image cap">
                        <div class="card-header bg-success text-light">
                            <span class="fa fa-clock"></span>
                            امروز
                            {{ Jdate.jdate('l , d/F/Y','now'|date('U')) }}
                        </div>
                        <div class="card-body p-0 m-0">
                            <ul class="list-group m-0 p-0">
                            
                                {% for countdown in countdowns %}
                                    {% set dayArrive = (countdown.timearrive - Jdate.time())/86400 %}
                                    <li class="rounded-0 list-group-item d-flex justify-content-between my-0 {% if dayArrive < 10 %}bg-warning{% endif %}">
                                        <div>
                                            <h4 class="my-0 text-dark">
                                                تا
                                                {{ countdown.title }}</h4>
                                            <small class="text-muted">{{ Jdate.jdate('(Y/n/d)',countdown.timearrive) }} {{ countdown.des }}</small>
                                        </div>
                                        <button type="button" class="btn btn-primary">
                                            {% if dayArrive | number_format(0, '.', ',') > 0 %}
                                                {{ dayArrive | number_format(0, '.', ',') }}
                                                روز
                                            {% elseif dayArrive | number_format(0, '.', ',') == 0 %}
                                                امروز
                                            {% else %}
                                                {{ dayArrive | number_format(0, '.', ',') }}
                                                روز پیش
                                            {% endif %}    
                                        </button>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                    <div class="list-group pt-2">
                        <a href="{{ path('apps') }}" class="list-group-item list-group-item-action active">
                            <i class="fas fa-bars"></i>
                            سامانه‌ها
                        </a>
                        {% set menuItems = EntityMGR.findAll('App:SysMenuItem') %}
                        {% for menuItem in menuItems %}
                            <a href="{{ menuItem.url | raw}}" class="list-group-item list-group-item-action">
                                {{ menuItem.fontawsome | raw }}
                                {{ menuItem.label | raw}}
                            </a>
                        {% endfor %}

                        <a href="{{ path('ISOformsView') }}" class="list-group-item list-group-item-action">
                            <i class="far fa-books"></i>
                            سامانه IMS
                        </a>
                        <a href="{{ path('phonebook',{'msg':0,'search':0}) }}" class="list-group-item list-group-item-action">
                            <i class="fas fa-book"></i>
                            دفترچه تلفن
                        </a>
                        <a href="{{ path('mostusedfilesView') }}" class="list-group-item list-group-item-action">
                            <i class="fas fa-box-alt"></i>
                            فرم های پرکاربرد
                        </a>
                    </div>
                </div>
                <div class="col-12 pb-1">
                    <div class="card">
                        <div class="card-header text-center bg-primary text-light">
                            تابلو اعلانات
                        </div>
                        <div class="card-body">
                            <ul class="">
                                {% set posts = EntityMGR.findByPage('App:NewsPost',1,10) %}
                                {% for post in posts %}
                                    <li><a href="{{ path('newsShowPost',{'id':post.id}) }}">{{ post.title }}</a></li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-9">
            {% if breadcrumb is not defined %}
                <ol class="breadcrumb my-2">
                    <li class="breadcrumb-item"><a class="" href="{{ path('home') }}">
                            <i class="fas fa-home"></i>
                            پورتال اصلی
                        </a></li>
                    <li class="breadcrumb-item"><a class="" href="{{ path('apps') }}">
                            <i class="fal fa-window-alt"></i>
                            برنامه‌ها
                        </a>
                    </li>
                    <li class="breadcrumb-item active">{{ block('title') }}</li>
                </ol>
            {% endif %}

            {% block appBody %}{% endblock %}
        </div>
    </div>
{% endblock %}
